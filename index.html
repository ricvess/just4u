<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SAEY:Ly â€” JUST 36:9 U</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Space+Grotesk:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg:#0b0c10; --fg:#f2f2f2; --muted:#b7b7b7;
      --accent:#ffd86b; --accent-2:#6df1ff; --card:#12141a;
      --shadow:rgba(0,0,0,.35); --ring:rgba(255,216,107,.35);
      --ease:cubic-bezier(.2,.9,.3,1);
      --maxw:1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Space Grotesk',system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;color:var(--fg);background:var(--bg);overflow-x:hidden}
    a{color:inherit;text-decoration:none}

    /* background + grain */
    .bg{position:fixed;inset:0;z-index:-20;background:
      radial-gradient(1200px 800px at 10% 10%, #1a2a6c 0%, transparent 60%),
      radial-gradient(1000px 600px at 90% 30%, #fdbb2d55 0%, transparent 60%),
      radial-gradient(900px 700px at 40% 90%, #22c1c355 0%, transparent 60%),var(--bg);
      filter:saturate(1.05) contrast(1.05); animation:bgShift 18s ease-in-out infinite alternate;}
    @keyframes bgShift{to{filter:hue-rotate(20deg) saturate(1.2)}}
    .grain{position:fixed;inset:0;pointer-events:none;z-index:-19;background:
      repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 3px),
      repeating-linear-gradient(90deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 3px);
      mix-blend-mode:soft-light; opacity:.8}

    /* HERO */
    header.hero{min-height:92vh;display:grid;place-items:center;text-align:center;padding:48px 20px 24px;position:relative}
    .logo{font-family:'Cinzel Decorative',serif;letter-spacing:.06em;text-shadow:0 10px 30px var(--shadow)}
    .title-stack{line-height:1.06}
    .title-giant{font-size:clamp(40px,8vw,92px);font-weight:900;margin:0;color:var(--accent);filter:drop-shadow(0 12px 40px var(--shadow));transition:opacity .45s var(--ease), transform .45s var(--ease)}
    .title-alt{font-size:clamp(22px,3.4vw,40px);margin:10px 0 0;color:var(--accent-2);opacity:.92;transition:opacity .45s var(--ease), transform .45s var(--ease)}
    .subtitle{margin-top:16px;font-size:clamp(14px,2.2vw,18px);color:var(--muted)}

    .chipbar{display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:22px}
    .chip{border:1px solid var(--ring);color:var(--fg);background:rgba(255,255,255,.02);padding:10px 14px;border-radius:999px;backdrop-filter:blur(4px);cursor:pointer;transition:transform .12s,var(--ease);box-shadow:0 10px 20px -10px var(--shadow)}
    .chip:hover{transform:translateY(-3px)}
    .chip.active{border-color:var(--accent);box-shadow:0 12px 30px -8px var(--shadow)}

    main{max-width:var(--maxw);margin:0 auto;padding:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border-radius:18px;padding:22px;border:1px solid rgba(255,255,255,.08);box-shadow:0 24px 80px -40px var(--shadow);margin:28px 0;opacity:0;transform:translateY(12px);transition:opacity .6s var(--ease),transform .6s var(--ease)}
    .card.visible{opacity:1;transform:translateY(0)}
    h2.section-title{font-family:'Cinzel Decorative',serif;font-size:clamp(20px,2.6vw,30px);margin:0 0 10px;color:var(--accent)}

    .muted{color:var(--muted)}
    .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.18),transparent);margin:18px 0}

    /* floating shapes improved */
    #floaties{position:fixed;inset:0;pointer-events:none;z-index:-5}
    .floaty{position:absolute;opacity:0.7;mix-blend-mode:screen;will-change:transform,opacity;filter:blur(.3px)}
    /* small different styles generated by JS */

    /* ABOUT bilingual layout */
    .about-columns{display:grid;grid-template-columns:1fr 1fr;gap:16px;align-items:start}
    @media(max-width:820px){.about-columns{grid-template-columns:1fr}}

    /* LYRICS improved (card list & highlight) */
    .lyrics-wrap{display:flex;flex-direction:column;gap:12px}
    .ly-list{background:var(--card);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.06);max-height:240px;overflow:auto}
    .ly-line{padding:10px 12px;border-radius:10px;color:var(--muted);transition:background .25s var(--ease),color .25s var(--ease),transform .18s var(--ease)}
    .ly-line.active{background:linear-gradient(90deg, rgba(255,216,107,.06), rgba(109,241,255,.03));color:var(--fg);transform:translateX(6px);font-weight:600}
    .lyrics-controls{display:flex;gap:10px;align-items:center;margin-top:8px}

    /* VINYL player improved */
    .vinyl-wrap{display:grid;grid-template-columns:260px 1fr;gap:18px;align-items:center}
    @media(max-width:820px){.vinyl-wrap{grid-template-columns:1fr}}
    .vinyl{width:220px;height:220px;border-radius:50%;border:10px solid #0b0b0b;background:radial-gradient(circle,#222 32%, #000 100%);position:relative;box-shadow:inset 0 0 0 3px rgba(255,255,255,.03),0 20px 60px -30px var(--shadow)}
    .vinyl img{width:88px;height:88px;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 8px 30px rgba(0,0,0,.45)}
    .vinyl.playing{animation:spin 4s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .playlist{display:flex;flex-direction:column;gap:8px}
    .track-row{display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;background:rgba(255,255,255,.02);cursor:pointer;border:1px solid rgba(255,255,255,.03)}
    .track-row:hover{transform:translateY(-3px)}
    .track-row.active{background:linear-gradient(90deg, rgba(255,216,107,.06), rgba(109,241,255,.03));border-color:rgba(255,216,107,.12)}
    .track-title{font-weight:600}

    .controls{display:flex;align-items:center;gap:12px;margin-top:12px}
    .play-btn{width:54px;height:54px;border-radius:999px;border:1px solid rgba(255,255,255,.08);display:grid;place-items:center;background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));cursor:pointer;box-shadow:0 12px 30px -18px var(--shadow)}
    .play-btn svg{width:22px;height:22px;fill:var(--fg)}
    .small-btn{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.06);background:transparent;cursor:pointer}

    .progress{height:10px;background:rgba(255,255,255,.03);border-radius:999px;overflow:hidden;width:100%}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}

    .time-stamp{font-size:12px;color:var(--muted)}

    /* Countdown big */
    .countdown-large{display:flex;gap:12px;justify-content:center;align-items:center;margin-top:12px;flex-wrap:wrap}
    .count-block{min-width:96px;padding:18px 12px;text-align:center;border-radius:12px;background:var(--card);border:1px solid rgba(255,255,255,.06);box-shadow:0 18px 40px -28px var(--shadow)}
    .count-block .num{font-size:28px;font-weight:800;color:var(--fg)}
    .count-block .label{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;margin-top:6px}
    .live-badge{display:inline-block;padding:6px 12px;border-radius:999px;background:linear-gradient(90deg,#ff7b7b33,#ffb3b3aa);color:#fff;font-weight:700}

    /* Coming soon */
    .coming-soon{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .soon-pill{padding:10px 14px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,.02), rgba(255,255,255,.01));border:1px dashed rgba(255,255,255,.06);color:var(--muted)}

    /* Theme picker buttons (better visibility than <select>) */
    .theme-pickers{display:flex;gap:8px;flex-wrap:wrap}
    .theme-btn{padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.06);background:transparent;color:var(--fg);cursor:pointer}
    .theme-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#111}

    @media(max-width:600px){
      .title-giant{font-size:40px}
      .vinyl{width:170px;height:170px}
      .vinyl img{width:64px;height:64px}
    }
  </style>
</head>
<body data-theme="dark-neon">
  <div class="bg" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>

  <!-- Floating shapes -->
  <div id="floaties" aria-hidden="true"></div>

  <!-- HERO -->
  <header class="hero">
    <div class="title-stack logo" id="heroTitle" tabindex="0" role="button">
      <h1 class="title-giant" id="heroMain">JUST 36:9 U</h1>
      <div class="title-alt" id="heroAlt" style="opacity:0; transform:translateY(6px)">JUST 4 U</div>
      <div class="subtitle">â€œ36 divide 9, and my heart just for youâ€</div>

      <div class="chipbar" style="margin-top:20px;">
        <a class="chip" href="#about">About</a>
        <a class="chip" href="#lyrics">Lyrics</a>
        <a class="chip" href="#vinyl">Player</a>
        <a class="chip" href="#countdown">Countdown</a>
        <a class="chip" href="#gallery">Gallery</a>
      </div>
    </div>
  </header>

  <main id="main" style="max-width:var(--maxw);margin:0 auto;padding:20px">
    <!-- ABOUT -->
    <section id="about" class="card" aria-labelledby="aboutTitle">
      <h2 id="aboutTitle" class="section-title">About this comeback</h2>
      <div class="about-columns">
        <div>
          <h3 style="margin-top:0">English</h3>
          <p>SAEY:Ly returns with the single <strong>â€œJUST 36:9 Uâ€</strong> â€” a warm retro-indie song with a playful numeric twist. The title contains a little code meant for someone special.</p>
        </div>
        <div>
          <h3 style="margin-top:0">í•œêµ­ì–´ (Korean)</h3>
          <p>SAEY:Lyê°€ ì‹±ê¸€ <strong>â€œJUST 36:9 Uâ€</strong>ë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤ â€” ë³µê³ í’ì˜ ë”°ëœ»í•œ ì¸ë””ê³¡ìœ¼ë¡œ ìˆ«ìì˜ ì¥ë‚œìŠ¤ëŸ¬ìš´ ì˜ë¯¸ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì œëª© ì† ì‘ì€ ì½”ë“œëŠ” íŠ¹ë³„í•œ ëˆ„êµ°ê°€ë¥¼ ìœ„í•œ ë©”ì‹œì§€ì…ë‹ˆë‹¤.</p>
        </div>
      </div>
      <div class="divider"></div>
      <p class="muted">Play snippet removed from About â€” full music controls moved to the Player section below.</p>
    </section>

    <!-- LYRICS improved -->
    <section id="lyrics" class="card" aria-labelledby="lyricsTitle">
      <h2 id="lyricsTitle" class="section-title">Lyrics preview</h2>
      <div class="lyrics-wrap">
        <div class="ly-list" id="lyList" role="list"></div>

        <div class="lyrics-controls">
          <button class="btn" id="lyPlay">â–¶ Play</button>
          <button class="btn" id="lyPause">â¸ Pause</button>
          <div style="margin-left:auto" class="muted">Karaoke-style preview â€” lines highlight automatically.</div>
        </div>
      </div>
    </section>

    <!-- VINYL PLAYER improved -->
    <section id="vinyl" class="card" aria-labelledby="vinylTitle">
      <h2 id="vinylTitle" class="section-title">Vinyl Player</h2>

      <div class="vinyl-wrap">
        <div style="display:flex;flex-direction:column;align-items:center;">
          <div id="vinylDisc" class="vinyl" aria-hidden="false">
            <img id="vinylCover" src="https://i.imgur.com/6rK2Kqb.jpeg" alt="cover">
          </div>
          <div id="trackMeta" class="muted" style="margin-top:8px">Now playing: â€”</div>
        </div>

        <div>
          <div class="playlist" id="playlist">
            <!-- populated by JS -->
          </div>

          <div class="controls">
            <button class="small-btn" id="prevBtn">âŸ¨ Prev</button>

            <button class="play-btn" id="playBtnVin">
              <!-- play icon -->
              <svg viewBox="0 0 24 24" id="playIcon"><path d="M8 5v14l11-7z"></path></svg>
              <!-- pause icon hidden by default; swapped by JS -->
            </button>

            <button class="small-btn" id="nextBtn">Next âŸ©</button>

            <div style="flex:1;margin-left:12px">
              <div class="progress" id="progBar" aria-hidden="true"><i style="width:0%"></i></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px">
                <div class="time-stamp" id="curT">0:00</div>
                <div class="time-stamp muted" id="durT">0:00</div>
              </div>
            </div>
          </div>

          <div style="margin-top:12px" class="muted">Tip: click a track to load. Click the progress bar to seek.</div>

          <!-- hidden audio element -->
          <audio id="vinAudio" preload="metadata" style="display:none"></audio>
        </div>
      </div>
    </section>

    <!-- Countdown -->
    <section id="countdown" class="card" aria-labelledby="countTitle">
      <h2 id="countTitle" class="section-title">Release Countdown</h2>
      <p class="muted">Counting down to <strong>25 Sept 2025 â€” 00:00 KST (UTC+9)</strong></p>

      <div class="countdown-large" id="countArea" aria-live="polite">
        <div class="count-block"><div class="num" id="cdDays">0</div><div class="label">Days</div></div>
        <div class="count-block"><div class="num" id="cdHours">0</div><div class="label">Hours</div></div>
        <div class="count-block"><div class="num" id="cdMins">0</div><div class="label">Minutes</div></div>
        <div class="count-block"><div class="num" id="cdSecs">0</div><div class="label">Seconds</div></div>
      </div>
      <div style="text-align:center;margin-top:12px"><div id="countStatus" class="muted"></div></div>
    </section>

    <!-- Gallery -->
    <section id="gallery" class="card" aria-labelledby="galleryTitle">
      <h2 id="galleryTitle" class="section-title">Gallery</h2>
      <p class="muted">Poster/teaser space â€” coming soon.</p>
      <div style="display:flex;justify-content:center">
        <img src="https://images.unsplash.com/photo-1549887534-1541e9326642?q=80&w=1200&auto=format&fit=crop" alt="Poster teaser" style="width:100%;max-width:520px;border-radius:18px;box-shadow:0 24px 70px -40px var(--shadow);border:1px solid rgba(255,255,255,.14)">
      </div>
    </section>

    <!-- Merch (coming soon) -->
    <section id="merch" class="card" aria-labelledby="merchTitle">
      <h2 id="merchTitle" class="section-title">Merch Store â€” Coming Soon</h2>
      <div class="coming-soon">
        <p class="muted">Official tee, vinyl press, posters â€” store launching soon.</p>
        <div class="soon-pill">Merch launch coming soon ğŸ›ï¸</div>
      </div>
    </section>
  </main>

  <footer style="text-align:center;color:var(--muted);padding:28px 8px">
    Â© 2025 SAEY:Ly. All rights reserved.
  </footer>

  <!-- DOCK: theme buttons + floaties control -->
  <div class="dock" role="region" aria-label="Controls">
    <div class="panel" style="display:flex;flex-direction:column;gap:8px">
      <label style="font-size:12px;color:var(--muted)">Theme</label>
      <div class="theme-pickers" id="themePickers">
        <button class="theme-btn active" data-theme="dark-neon">Dark Neon</button>
        <button class="theme-btn" data-theme="retro-pink">Retro Pink</button>
        <button class="theme-btn" data-theme="indie-beige">Indie Beige</button>
        <button class="theme-btn" data-theme="teal-orange">Teal & Orange</button>
        <button class="theme-btn" data-theme="mono-minimal">Mono Minimal</button>
      </div>
    </div>

    <div class="panel" style="display:flex;flex-direction:column;gap:8px">
      <label style="font-size:12px;color:var(--muted)">Floating shapes</label>
      <input id="shapeCount" type="range" min="0" max="40" value="16">
    </div>
  </div>

  <script>
  /* ---------------------------
     Utilities
     --------------------------- */
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));
  function rand(min,max){ return Math.random()*(max-min)+min }

  /* ---------------------------
     Improved floating shapes
     --------------------------- */
  const floatiesWrap = $('#floaties');
  function createFloaties(n=16){
    floatiesWrap.innerHTML = '';
    for(let i=0;i<n;i++){
      const el = document.createElement('div');
      el.className = 'floaty';
      const size = Math.floor(rand(8,46));
      el.style.width = size + 'px';
      el.style.height = size + 'px';
      el.style.left = rand(-5,105) + 'vw';
      el.style.top = rand(-5,95) + 'vh';
      el.style.opacity = rand(.18,.7);
      // color variation
      const useAccent = Math.random() > 0.5;
      if(useAccent) el.style.background = `radial-gradient(circle at 30% 30%, var(--accent), transparent 60%)`;
      else el.style.background = `radial-gradient(circle at 30% 30%, var(--accent-2), transparent 60%)`;
      // random shape transform
      if(Math.random() > 0.7) el.style.borderRadius = '8px';
      else el.style.borderRadius = '50%';
      // animation
      const dur = rand(6,18);
      const dx = rand(-30,30);
      const dy = rand(-30,30);
      el.animate(
        [
          { transform: `translate(0,0) rotate(0deg)` , opacity: el.style.opacity },
          { transform: `translate(${dx}px,${-dy}px) rotate(${rand(-180,180)}deg)`, opacity: Math.max(0.2, el.style.opacity - 0.15) },
          { transform: `translate(0,0) rotate(0deg)`, opacity: el.style.opacity }
        ],
        { duration: dur*1000, iterations: Infinity, direction: 'alternate', easing: 'ease-in-out', delay: (rand(0,4)*1000) }
      );
      floatiesWrap.appendChild(el);
    }
  }
  createFloaties(parseInt($('#shapeCount').value,10));
  $('#shapeCount').addEventListener('input', e => createFloaties(parseInt(e.target.value,10)));

  /* ---------------------------
     Hero title cycle: JUST 4 U -> JUST FOR YOU
     --------------------------- */
  const heroMain = $('#heroMain');
  const heroAlt = $('#heroAlt');
  let heroStage = 0;
  function cycleHero(){
    // sequence: JUST 36:9 U (initial) -> JUST 4 U -> JUST FOR YOU -> back to JUST 36:9 U
    if(heroStage === 0){
      // show JUST 4 U as alt (fade in)
      heroAlt.textContent = 'JUST 4 U';
      heroAlt.style.opacity = 1;
      heroAlt.style.transform = 'translateY(0)';
      heroStage = 1;
    } else if(heroStage === 1){
      heroMain.style.opacity = 0;
      heroAlt.style.opacity = 0;
      setTimeout(()=>{
        heroMain.textContent = 'JUST FOR YOU';
        heroMain.style.opacity = 1;
        heroMain.style.transform = 'translateY(0)';
        heroStage = 2;
      }, 400);
    } else {
      // back to original
      heroMain.style.opacity = 0;
      setTimeout(()=>{
        heroMain.textContent = 'JUST 36:9 U';
        heroMain.style.opacity = 1;
        heroAlt.style.opacity = 0;
        heroStage = 0;
      }, 400);
    }
  }
  // run gentle cycles every ~4.5s after initial load
  setTimeout(()=>{ cycleHero(); }, 900);
  setInterval(()=>{ cycleHero(); }, 4500);

  // clicking title re-runs animation quickly
  $('#heroTitle').addEventListener('click', ()=> { cycleHero(); });

  /* ---------------------------
     Section reveal on scroll
     --------------------------- */
  function reveal(){
    $$('.card').forEach(c=>{
      const r = c.getBoundingClientRect();
      if(r.top < window.innerHeight - 80) c.classList.add('visible');
    });
  }
  window.addEventListener('scroll', reveal);
  window.addEventListener('load', reveal);

  /* ---------------------------
     LYRICS preview (better)
     - display list of lines
     - autoplay highlight loop with smooth scroll
     --------------------------- */
  const LINES = [
    "36 divide 9, and my heart just for you",
    "Night falls soft and the city sings",
    "Vinyl spins our quiet things",
    "I keep a code, a little clue â€” just for you"
  ];
  const lyList = $('#lyList');
  function renderLyrics(){
    lyList.innerHTML = '';
    LINES.forEach((ln, i)=>{
      const div = document.createElement('div');
      div.className = 'ly-line';
      div.dataset.idx = i;
      div.textContent = ln;
      div.addEventListener('click', ()=>{ // manual click to highlight and pause autoplay
        stopLy();
        activateLyLine(i);
      });
      lyList.appendChild(div);
    });
  }
  let lyTimer = null;
  let lyIndex = 0;
  function activateLyLine(i){
    $$('.ly-line').forEach(x=>x.classList.remove('active'));
    const lines = $$('.ly-line');
    if(lines[i]) {
      lines[i].classList.add('active');
      lines[i].scrollIntoView({behavior:'smooth',block:'center'});
    }
  }
  function startLy(){
    stopLy();
    activateLyLine(0);
    lyIndex = 1;
    lyTimer = setInterval(()=>{
      activateLyLine(lyIndex);
      lyIndex = (lyIndex + 1) % LINES.length;
    }, 2000);
  }
  function stopLy(){ if(lyTimer){ clearInterval(lyTimer); lyTimer = null; } }
  $('#lyPlay').addEventListener('click', startLy);
  $('#lyPause').addEventListener('click', stopLy);
  renderLyrics();

  /* ---------------------------
     VINYL PLAYER improved
     - playlist UI (custom rows)
     - play/pause big button, prev/next, progress & seek
     --------------------------- */
  const PLAYLIST = [
    { title: 'JUST 36:9 U â€” Teaser', src: '', cover: 'https://i.imgur.com/6rK2Kqb.jpeg' },
    { title: 'Retro Night (demo)', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', cover: 'https://i.imgur.com/6rK2Kqb.jpeg' },
    { title: 'Morning For U (demo)', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3', cover: 'https://i.imgur.com/fVQpLqT.jpeg' }
  ];
  const playlistWrap = $('#playlist');
  const vinAudio = $('#vinAudio');
  const vinylDisc = $('#vinylDisc');
  const vinylCover = $('#vinylCover');
  const trackMeta = $('#trackMeta');
  const progBar = $('#progBar > i');
  const curT = $('#curT'), durT = $('#durT');
  const playBtnVin = $('#playBtnVin'), prevBtn = $('#prevBtn'), nextBtn = $('#nextBtn');

  function populatePlaylist(){
    playlistWrap.innerHTML = '';
    PLAYLIST.forEach((p, idx)=>{
      const row = document.createElement('div');
      row.className = 'track-row';
      row.dataset.idx = idx;
      row.innerHTML = `<div style="width:44px;height:44px;border-radius:8px;overflow:hidden"><img src="${p.cover}" alt="" style="width:100%;height:100%;object-fit:cover"></div>
        <div style="flex:1"><div class="track-title">${p.title}</div><div class="muted" style="font-size:12px">${p.src? 'local/demo' : 'no file'}</div></div>`;
      row.addEventListener('click', ()=> loadTrack(idx, true));
      playlistWrap.appendChild(row);
    });
  }
  let currentIdx = 0;
  function setActiveRow(){
    $$('.track-row').forEach(r=>r.classList.remove('active'));
    const r = $(`.track-row[data-idx="${currentIdx}"]`);
    if(r) r.classList.add('active');
  }

  function loadTrack(i, autoplay=false){
    currentIdx = i;
    const t = PLAYLIST[i];
    vinylCover.src = t.cover || '';
    trackMeta.textContent = 'Now playing: ' + t.title;
    // set audio src
    vinAudio.pause();
    vinAudio.removeAttribute('src');
    vinAudio.src = t.src || '';
    vinAudio.load();
    setActiveRow();
    if(autoplay && vinAudio.src) vinAudio.play();
    updateDur();
  }

  // play/pause toggle
  playBtnVin.addEventListener('click', ()=>{
    if(!vinAudio.src) { alert('No audio source for this track (replace PLAYLIST src with your file).'); return; }
    if(vinAudio.paused) vinAudio.play(); else vinAudio.pause();
  });
  prevBtn.addEventListener('click', ()=> loadTrack((currentIdx-1+PLAYLIST.length)%PLAYLIST.length, true));
  nextBtn.addEventListener('click', ()=> loadTrack((currentIdx+1)%PLAYLIST.length, true));

  // update play button icon on play/pause
  vinAudio.addEventListener('play', ()=>{
    vinylDisc.classList.add('playing');
    // swap icon to pause
    playBtnVin.innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>';
  });
  vinAudio.addEventListener('pause', ()=>{
    vinylDisc.classList.remove('playing');
    playBtnVin.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>';
  });

  // timeupdate & progress
  vinAudio.addEventListener('timeupdate', ()=>{
    if(!vinAudio.duration || isNaN(vinAudio.duration)) return;
    const pct = (vinAudio.currentTime / vinAudio.duration) * 100;
    progBar.style.width = pct + '%';
    curT.textContent = formatTime(vinAudio.currentTime);
    durT.textContent = formatTime(vinAudio.duration);
  });
  // click to seek
  $('#progBar').addEventListener('click', e=>{
    if(!vinAudio.duration) return;
    const rect = e.currentTarget.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const pct = Math.max(0, Math.min(1, x / rect.width));
    vinAudio.currentTime = pct * vinAudio.duration;
  });

  // when track ends -> auto next
  vinAudio.addEventListener('ended', ()=> {
    loadTrack((currentIdx+1)%PLAYLIST.length, true);
  });

  function formatTime(sec){
    if(!sec || isNaN(sec)) return '0:00';
    sec = Math.floor(sec);
    const m = Math.floor(sec/60);
    const s = sec%60;
    return m + ':' + (s<10?'0'+s:s);
  }
  function updateDur(){
    durT.textContent = vinAudio.duration ? formatTime(vinAudio.duration) : '0:00';
  }

  populatePlaylist();
  loadTrack(0,false);

  /* ---------------------------
     Countdown to 25 Sept 2025 00:00 KST
     --------------------------- */
  const target = new Date('2025-09-25T00:00:00+09:00'); // KST
  const dEl = $('#cdDays'), hEl = $('#cdHours'), mEl = $('#cdMins'), sEl = $('#cdSecs'), st = $('#countStatus');
  function updateCountdown(){
    const now = new Date();
    const diff = target.getTime() - now.getTime();
    if(diff <= 0){
      dEl.textContent = 0; hEl.textContent = 0; mEl.textContent = 0; sEl.textContent = 0;
      st.innerHTML = '<span class="live-badge">LIVE</span> â€” Release started!';
      return;
    }
    const days = Math.floor(diff / (1000*60*60*24));
    const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
    const mins = Math.floor((diff % (1000*60*60)) / (1000*60));
    const secs = Math.floor((diff % (1000*60)) / 1000);
    dEl.textContent = days; hEl.textContent = hours; mEl.textContent = mins; sEl.textContent = secs;
    st.textContent = 'Counting down to 25 Sept 2025, 00:00 KST';
  }
  updateCountdown();
  setInterval(updateCountdown,1000);

  /* ---------------------------
     Smooth scroll for chips
     --------------------------- */
  $$('.chip').forEach(ch=>{
    ch.addEventListener('click', e=>{
      const href = ch.getAttribute('href');
      if(href && href.startsWith('#')){
        e.preventDefault();
        const target = document.querySelector(href);
        if(target) target.scrollIntoView({behavior:'smooth',block:'start'});
      }
    });
  });

  /* ---------------------------
     Theme buttons (visible labels + active state)
     --------------------------- */
  $$('#themePickers .theme-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      $$('#themePickers .theme-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const theme = btn.dataset.theme;
      document.body.setAttribute('data-theme', theme);
      // tweak bg variations visually
      const bg = document.querySelector('.bg');
      if(theme === 'retro-pink') bg.style.background = 'radial-gradient(1000px 600px at 15% 15%, #ff7eb399 0%, transparent 60%), radial-gradient(900px 600px at 85% 35%, #ffd86b55 0%, transparent 60%), radial-gradient(900px 700px at 40% 90%, #ffb6c199 0%, transparent 60%), #1b0f17';
      else if(theme === 'indie-beige') bg.style.background = 'radial-gradient(1100px 700px at 20% 20%, #d7b88988 0%, transparent 60%), radial-gradient(900px 600px at 80% 30%, #a3e1d188 0%, transparent 60%), radial-gradient(900px 700px at 40% 90%, #6c584c66 0%, transparent 60%), #1a1816';
      else if(theme === 'teal-orange') bg.style.background = 'radial-gradient(1000px 600px at 15% 15%, #2ec4b6aa 0%, transparent 60%), radial-gradient(900px 600px at 85% 35%, #f4a25988 0%, transparent 60%), radial-gradient(900px 700px at 40% 90%, #3a506baa 0%, transparent 60%), #0f1b1a';
      else if(theme === 'mono-minimal') bg.style.background = 'radial-gradient(1000px 600px at 15% 15%, #ffffff18 0%, transparent 60%), radial-gradient(900px 600px at 85% 35%, #ffffff10 0%, transparent 60%), radial-gradient(900px 700px at 40% 90%, #ffffff0e 0%, transparent 60%), #0f0f0f';
      else bg.style.background = '';
      // ensure text readability across themes: tweak card/text colors if necessary (kept minimal)
    });
  });

  /* ---------------------------
     Initialize small things on load
     --------------------------- */
  window.addEventListener('load', ()=>{
    reveal();
    // ensure hero initial text
    heroMain.textContent = 'JUST 36:9 U';
    heroAlt.style.opacity = 0;
  });

  </script>
</body>
</html>
